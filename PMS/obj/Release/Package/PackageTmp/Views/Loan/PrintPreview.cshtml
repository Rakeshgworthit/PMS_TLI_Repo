<!--Loan Print-->
@model PMS.Models.PrintPaymentViewModel
@using PMS.Common
@{
    Layout = null;
}
<style>
    .printaddress {
        font-size: 11px;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .textlabel {
        font-size: 13px;
        font-weight: bold;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .textlabelnormal {
        font-size: 13px;
        font-weight: normal;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .tablebgcolor {
        background-color: #000000;
        /*border-spacing: 1px !important;*/
        border-collapse: separate !important;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .trbgcolor {
        background-color: #ffffff;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .trbgcolorextra {
        /*border-bottom: solid 1px #000000;*/
        background-color: #ffffff;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }

    .trbgcolorextratopbottom {
        /*border-top: solid 1px #000000;
        border-bottom: solid 1px #000000;*/
        background-color: #ffffff;
        font-family: "Proxima Nova";
        text-transform: uppercase;
    }
</style>
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">&times;</button>
    <h4 class="modal-title">Print Preview</h4>
</div>
<div class="modal-body">
    <form class="form-horizontal" id="frmPayment" name="frmPayment">
        <div id="PrintElement">
            <center>
                <table width="95%" border="0" style="color:#000000!important">
                    <tr>
                        <td align="left" valign="top" width="60%"></td>

                        <td align="right" valign="top" width="15%"></td>

                        <td align="left" valign="top" width="25%"></td>
                    </tr>
                    <tr>
                        <td valign="top" colspan="3">
                            <b style="font-size:25px; font-family:Proxima Nova; ">@Model.LoanPrint.branch_name.ToUpper()</b>
                        </td>
                    </tr>
                    <tr>
                        <td align="left" valign="top" colspan="2" class="textlabelnormal trbgcolor">
                            @Model.LoanPrint.address1

                            @if ((!String.IsNullOrWhiteSpace(Model.LoanPrint.phone)))
                            {
                                <span>Tel: @Model.LoanPrint.brphone</span>
                            }
                        </td>
                        <td align="left" valign="top" colspan="1">
                            <b class="trbgcolor"> Payment Voucher</b>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" valign="top" class="textlabel" colspan="3">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <table width="100%" border="0" class="tablebgcolor" cellpadding="1" cellspacing="1">
                                <tr>
                                    <td align="right" valign="top" width="13%"></td>

                                    <td align="left" valign="top" width="21%"></td>

                                    <td align="left" valign="top" width="10%"></td>

                                    <td align="left" valign="top" width="16%"></td>

                                    <td align="left" valign="top" width="20%"></td>

                                    <td align="left" valign="top" width="20%"></td>

                                </tr>

                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor">
                                        <b>Person :</b>
                                    </td>
                                    <td class="textlabelnormal trbgcolor" valign="top" align="left" colspan="3"> @Model.LoanPrint.person_name</td>

                                    <td align="right" valign="top" class="textlabel trbgcolor">
                                        <b>Payment Date :</b>
                                    </td>
                                    <td align="left" valign="top" class="textlabelnormal trbgcolor">
                                        @Model.LoanPrint.loan_date
                                    </td>
                                </tr>

                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor">
                                        <b>Type :</b>
                                    </td>
                                    <td class="textlabelnormal trbgcolor" valign="top" align="left" colspan="3">  @CommonFunction.GetRecordTypeById(Model.LoanPrint.rec_type)</td>
                                    <td align="right" valign="top" class="textlabel trbgcolor">
                                        <b>BANK NAME :</b>
                                    </td>
                                    <td align="left" class="textlabelnormal trbgcolor" valign="top">@Model.LoanPrint.bank_name</td>
                                </tr>

                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor">
                                        <b>Purpose :</b>
                                    </td>
                                    <td class="textlabelnormal trbgcolor" valign="top" align="left" colspan="3">  @Model.LoanPrint.purpose</td>
                                    <td align="right" valign="top" class="textlabel trbgcolor">
                                        <b>PAYMENT MODE :</b>
                                    </td>
                                    <td align="left" valign="top" class="textlabelnormal trbgcolor">@Model.LoanPrint.mode_of_payment</td>
                                </tr>

                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor" colspan="4">
                                        &nbsp;
                                    </td>
                                    <td align="right" valign="top" class="textlabel trbgcolor">
                                        <b>CHEQUE NO :</b>
                                    </td>
                                    <td align="left" valign="top" class="textlabelnormal trbgcolor">@Model.LoanPrint.cheque_number</td>
                                </tr>

                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor" colspan="4">
                                        &nbsp;
                                    </td>
                                    <td align="right" valign="top" class="textlabel trbgcolor">
                                        <b>AMOUNT :</b>
                                    </td>
                                    <td align="left" valign="top" class="textlabelnormal trbgcolor">$@Model.LoanPrint.amount.ToString("#,##0.00")</td>
                                </tr>
                                <tr>
                                    <td align="left" valign="top" class="textlabel trbgcolor">
                                        ADDRESS :
                                    </td>
                                    <td class="textlabelnormal trbgcolor" colspan="5">
                                        @Model.LoanPrint.home_address
                                        @if (!String.IsNullOrEmpty(Model.LoanPrint.zip_code))
                                        {
                                            <span>&nbsp;@Model.LoanPrint.zip_code</span>
                                        }
                                        @if (!String.IsNullOrEmpty(Model.LoanPrint.phone))
                                        {
                                            <span>&nbsp;@Model.LoanPrint.phone</span>
                                        }
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="textlabel" valign="top" colspan="6">
                            &nbsp;
                        </td>
                    </tr>
                    @if (Model.LoanDetails.Count() > 0)
                    {
                        <tr>
                            <td colspan="6">
                                <table width="100%" border="0" class="tablebgcolor" cellpadding="1" cellspacing="1">
                                    <tr>
                                        <td align="center" valign="top" class="textlabel trbgcolorextra" width="60%"><b>Project</b></td>
                                        <td align="center" valign="top" class="textlabel trbgcolorextra" width="40%"><b>Amount</b></td>
                                    </tr>
                                    <tr>
                                        <td align="center" valign="top" class="textlabel trbgcolorextra" colspan="2">
                                            &nbsp;
                                        </td>
                                    </tr>

                                    @foreach (var projectItem in Model.LoanDetails)
                                    {
                                        <tr>
                                            <td align="center" class="trbgcolor">
                                                @if (!String.IsNullOrEmpty(projectItem.project_name))
                                                {
                                                    @projectItem.project_name
                                                }
                                                else
                                                {
                                                    <b>--</b>
                                                }
                                                </td>
                                            <td align="center" class="trbgcolor">
                                                $@projectItem.amount.ToString("#,##0.00")
                                            </td>
                                        </tr>
                                    }
                                </table>
                            </td>
                        </tr>
                    }
                    <tr>
                        <td align="left" valign="top" class="textlabel" colspan="6">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td align="left" valign="top" class="textlabel" colspan="6">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td align="left" valign="top" class="textlabel">
                            <b>Approved by</b>
                        </td>
                        <td align="right" valign="top" class="textlabel">
                            <b>Received by</b>
                        </td>
                        <td>
                        </td>
                    </tr>
                    <tr>
                        <td align="left" valign="top" style="padding-left:93px">
                            <span style="border-top:solid 1px #000000;font-size:12px; text-transform: uppercase;">
                                <i>
                                    &nbsp;&nbsp;  (Signature & Date)&nbsp;&nbsp;&nbsp;
                                </i>
                            </span>
                        </td>

                        <td align="right" valign="top" colspan="2">
                            <span style="border-top:solid 1px #000000;font-size:12px; text-align:left; text-transform: uppercase;margin-right:40px">
                                <i>
                                    (Signature & Date)
                                </i>
                            </span>
                        </td>
                    </tr>
                </table>
            </center>
        </div>
    </form>
</div>
<div class="modal-footer">
    <button id="btnSave" name="btnSave" type="submit" class="btn btn-primary" onclick="PrintElem();">Print</button>
    <button id="btnClose" name="btnClose" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
<script>

    function PrintElem() {
        var elem = "PrintElement";
        var mywindow = window.open('', 'PRINT', 'height=400,width=600');

        mywindow.document.write('<html><head><title></title>');
        mywindow.document.write('<style>body{font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;} .printaddress { font-size: 10px;font-family: "Proxima Nova";text-transform: uppercase;} .textlabel { font-size: 12px;font-weight: bold;font-family: "Proxima Nova";text-transform: uppercase;} .textlabelnormal{ font-size: 12px;font-weight: normal;font-family: "Proxima Nova";text-transform: uppercase;} .tablebgcolor {background-color:#000000; border-spacing:1px!important;border-collapse: separate!important;font-family: "Proxima Nova";text-transform: uppercase;} .trbgcolor { background-color:#ffffff;font-family: "Proxima Nova";text-transform: uppercase;} .trbgcolorextra {  background-color:#ffffff; font-family: "Proxima Nova";text-transform: uppercase;} .trbgcolorextratopbottom { background-color:#ffffff; font-family: "Proxima Nova";text-transform: uppercase;} </style>');
        mywindow.document.write('</head><body >');

        mywindow.document.write(document.getElementById(elem).innerHTML);
        mywindow.document.write('</body></html>');

        mywindow.document.close(); // necessary for IE >= 10
        mywindow.focus(); // necessary for IE >= 10*/

        mywindow.print();
        mywindow.close();

        return false;
    }

</script>
